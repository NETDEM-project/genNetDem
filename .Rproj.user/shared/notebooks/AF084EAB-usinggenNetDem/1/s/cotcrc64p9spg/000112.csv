"0",""
"0","#Behavioural timesteps"
"0","beh_steps<-20"
"0","#Demographic timesteps"
"0","dem_steps<-10"
"0",""
"0","CG<-list()"
"0","OG<-list()"
"0",""
"0","SW_store<-list()"
"0",""
"0","inds_alive<-list()"
"0","pre_cap<-NULL"
"0",""
"0","for(ds in 1:dem_steps){"
"0","  "
"0","  inds_alive[[ds]]<-indiv_data$indivs"
"0","  "
"0","  #Sample over some behaviour only time steps"
"0","  int_info<-interaction_generation_simul(indiv_data=indiv_data,pop_mat=pop_mat,"
"0","                                         mean_group_size=2,n_ts=beh_steps,float=0.000000001,pm=50,pow=4)"
"0","  gbi<-int_info[[1]]"
"0","  samp_wind<-int_info[[2]]"
"0","  "
"0","  if(ds>1){"
"0","    if(ds==2){"
"0","      pre_cap_t<-sign(pre_cap[!is.na(pre_cap[,ds]),ds])"
"0","    }"
"0","    if(ds>2){"
"0","      pre_cap_t<-sign(rowSums(pre_cap[!is.na(pre_cap[,ds]),2:ds],na.rm=TRUE))"
"0","    }"
"0","    pre_cap_t<-pre_cap_t[names(pre_cap_t)%in%indiv_data$indivs]"
"0","    pre_cap_t2<-c(pre_cap_t,rep(0,sum(indiv_data$indivs%in%names(pre_cap_t)==FALSE)))"
"0","  }"
"0","  "
"0","  #Observe networks over these timesteps"
"0","  if(ds==1){"
"0","    obs_info<-cap_and_obs(samp_wind=samp_wind,gbi=gbi,"
"0","                          pcg=0.5,pmi=0.75,pci=0.75,"
"0","                          start_obs=1,end_obs=max(samp_wind),interval_obs=2,"
"0","                          start_cap=1,end_cap=4,interval_cap=1,"
"0","                          pre_cap=NULL)"
"0","  }"
"0","  if(ds>1){"
"0","    obs_info<-cap_and_obs(samp_wind=samp_wind,gbi=gbi,"
"0","                          pcg=0.5,pmi=0.75,pci=0.75,"
"0","                          start_cap=1,end_cap=4,interval_cap=1,"
"0","                          pre_cap=pre_cap_t2)"
"0","  }"
"0","  "
"0","  captured_gbi<-obs_info[[1]]"
"0","  captured_groups<-obs_info[[2]]"
"0","  observed_gbi<-obs_info[[3]]"
"0","  observed_groups<-obs_info[[4]]"
"0","  "
"0","  if(ds==1){"
"0","    pre_cap<-data.frame(indiv_data$indivs,sign(colSums(captured_gbi)))"
"0","    names(pre_cap)<-c(""ID"",""cap"")"
"0","  }"
"0","  if(ds>1){"
"0","    pre_cap_t<-data.frame(indiv_data$indivs,sign(colSums(captured_gbi)))"
"0","    names(pre_cap_t)<-c(""ID"",""cap"")"
"0","    pre_cap<-merge(pre_cap,pre_cap_t,by=""ID"",all.x=TRUE,all.y=TRUE)"
"0","  }"
"0","  "
"0","  CG[[ds]]<-captured_gbi"
"0","  OG[[ds]]<-observed_gbi"
"0","  "
"0","  SW_store[[ds]]<-samp_wind"
"0","  "
"0","  #Demographic timestep"
"0","  if(ds==1){"
"0","    new_info<-timestep_demographics(indiv_data=indiv_data,full_indiv_data=indiv_data,"
"0","                                    mps=mean(indiv_data$survival),lvps=0.5)"
"0","  }"
"0","  if(ds>1){"
"0","    new_info<-timestep_demographics(indiv_data=indiv_data,full_indiv_data=full_indiv_data,"
"0","                                    mps=mean(indiv_data$survival),lvps=0.5)"
"0","  }"
"0","  indiv_data<-new_info[[1]]"
"0","  full_indiv_data<-new_info[[2]]"
"0","  dist_mat<-new_info[[3]]"
"0","  "
"0","  indiv_info<-indiv_info_add(indiv_info[[1]],ii_tag=indiv_info[[2]],indiv_data=indiv_data)"
"0","  "
"0","  net_info<-network_rewire_covariates(network=pop_mat,"
"0","                                      indiv_data=indiv_data,prev_data=prev_data,dist_mat=dist_mat,indiv_info=indiv_info,"
"0","                                      p_ig=0.2,wi_m=0.25,wi_v=0.025,"
"0","                                      p_og=0.2,wo_m=0.25,wo_v=0.025,"
"0","                                      d_effp=4,d_effw=4,"
"0","                                      covs=2,effs,"
"0","                                      p_wr_i=0,p_wr_e=0.5,"
"0","                                      plot=TRUE)"
"0","  pop_net<-net_info[[2]]"
"0","  "
"0","}"
